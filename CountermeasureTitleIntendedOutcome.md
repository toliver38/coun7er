# Countermeasure Catalog
 
For Title and Intended Outcome standardization, please refer to the SOP for a description of Action-Effect Sequences and how to use them. See the end of this document for typical title and intended outcome issues. **Standardization of Titles and Intended Outcomes is now optional.** 

Potential & Obsolete (Closed) Countermeasures tables follow the Master List table.

LAST UPDATED: **2025-03-28T14:45 ET**

## Countermeasure - Master List
The table below shows countermeasures under development, along with their (sometimes standardized) titles and intended outcomes. The font of the identifier indicates the current status of the countermeasure:

- [Linked](./.): completed
- Plaintext: not completed
- *Italicized*: in original 51, under revision
- **Boldface**: not started and unassigned OR completed but edits required

Stages: Done, Not Started (NS), In Progress (IP), Pending Review - Assigned (PRA), Pending Review - Unassigned (PRU), Pending Revision (PE), and Pending Final Merge (PFM). Initial(s) after the stage indicates the assignee.

### Count = 160 (DONE:150, NS:0, IP:3, PRU:3, PRA:2, PE:2, PFM:0)

|ID |Countermeasure Title|Intended Outcome|
|---|--------------------|----------------|
|[CM0001](./countermeasures/CM0001_DisableServerMessageBlockProtocol.md)|Disable Server Message Block (SMB) Protocol|Disabling the Server Message Block (SMB) protocol blocks adversary lateral movement to admin shares using SMB.|
|[CM0002](./countermeasures/CM0002_EnableEmailAttachmentFilteringAndMessageAuthentication.md)|Enable Email Attachment Filtering and Message Authentication |Enabling email attachment filtering and enabling message authentication restricts adversary initial access using malicious files. |
|[CM0003](./countermeasures/CM0003_ConfigureFileAndDirectoryPermissions.md)|Configure File and Directory Permissions|Configuring file and directory permissions blocks adversary privilege escalation using lax permissions.|
|[CM0004](./countermeasures/CM0004_EnableWindowsDefenderExploitGuardAttackSurfaceReductionRules.md)|Enable Windows Defender Exploit Guard (WDEG) Attack Surface Reduction (ASR) Rules|Enabling Windows Defender Exploit Guard (WDEG) Attack Surface Reduction (ASR) rules restricts adversary lateral movement and persistence using malicious files and scripts.|
|[CM0005](./countermeasures/CM0005_MonitorOrBlockMicrosoftHtmlApplicationUtilityOrRestrictHtmlApplicationNetworkAccess.md)|Monitor or Block Microsoft HTML Application (MSHTA) Utility or Restrict HTML Application (HTA) Network Access|Monitoring or blocking the Microsoft HTML Application (MSHTA) utility detects or blocks adversary execution of malicious HTML Application (HTA) programs. Restricting HTA network access blocks adversary defense evasion using proxy execution of malicious HTA programs.|
|[CM0006](./countermeasures/CM0006_DisableAndMonitorRegasmAndRegsvcsUtilities.md)|Disable and Monitor Regasm.exe and Regsvcs.exe Utilities|Disabling or monitoring registration utilities blocks or detects adversary defense evasion using proxy execution of code.|
|[CM0007](./countermeasures/CM0007_DisableAndMonitorVerclsidSystemBinary.md)|Disable and Monitor Verclsid.exe System Binary|Disabling and monitoring the Verclsid.exe system binary blocks or detects adversary defense evasion using proxy execution of code.|
|[CM0008](./countermeasures/CM0008_BlockOrMonitorMavinjectUtility.md)|Block or Monitor Mavinject.exe Utility|Blocking or monitoring execution of the Mavinject.exe utility (Microsoft|
|[CM0009](./countermeasures/CM0009_UpdateDomainNameServiceDenyList.md)|Update Domain Name Service (DNS) Deny List|Updating the Domain Name Service (DNS) deny list blocks adversary command and control (C2). |
|[CM0010](./countermeasures/CM0010_EnableInternetProtocolAddressAllowlists.md)|Enable Internet Protocol (IP) Address Allowlists|Enabling Internet Protocol (IP) address allowlists restricts adversary|
|[CM0011](./countermeasures/CM0011_EnableDomainNameSystemSinkhole.md)-PRU|Enable Domain Name System (DNS) Sinkhole|Enabling a Domain Name System (DNS) sinkhole blocks adversary command|
|[CM0012](./countermeasures/CM0012_DisableOrRestrictDistributedComponentObjectModelProtocol.md)|Disable or Restrict Distributed Component Object Model (DCOM) Protocol|Disabling or restricting the Distributed Component Object Model (DCOM)|
|[CM0013](./countermeasures/CM0013_BlockWindowsManagementInstrumentationService.md)|Block Windows Management Instrumentation (WMI) Service|Blocking the Windows Management Instrumentation (WMI) service blocks adversary discovery, persistence, and lateral movement using WMI.|
|[CM0014](./countermeasures/CM0014_DisableCiscoSmartInstallFeature.md)|Disable Cisco Smart Install Feature|Disabling the Cisco Smart Install feature blocks adversary collection of|
|[CM0015](./countermeasures/CM0015_BlockDefaultScreensaverProgramsAndMonitorScrExecutableFiles.md)|Block Default Screensaver Programs and Monitor SCR Executable Files|Blocking default screensaver programs and monitoring SCR executable|
|[CM0016](./countermeasures/CM0016_RemoveSuspiciousPropertyListFiles.md)|Remove Suspicious Property List (PLIST) Files|Removing suspicious Property List (PLIST) files terminates adversary|
|[CM0017](./countermeasures/CM0017_EnablePortFilteringOnHostbasedFirewalls.md)|Enable Port Filtering on Host-based Firewalls|Enabling port filtering on host-based firewalls restricts adversary|
|[CM0018](./countermeasures/CM0018_EnableActiveDirectoryProtectedUsersSecurityGroup.md)|Enable Active Directory (AD) Protected Users Security Group|Enabling the Active Directory (AD) Protected Users security group|
|[CM0019](./countermeasures/CM0019_DisableOrRestrictWindowsRemoteManagementProtocol.md)|Disable or Restrict Windows Remote Management (WinRM) Protocol|Disabling or restricting the Windows Remote Management (WinRM) protocol|
|[CM0020](./countermeasures/CM0020_DisableVirtualNetworkComputingDesktopsharingSystem.md)-PRU|Disable Virtual Network Computing (VNC) Desktop-sharing System|Disabling the Virtual Network Computing (VNC) desktop-sharing system|
|[CM0021](./countermeasures/CM0021_EnableBehavioralAndHeuristicbasedMalwareDetection.md)|Enable Behavioral and Heuristic-based Malware Detection|Enabling behavioral and heuristic-based malware detection detects adversary execution of malicious code.|
|[CM0022](./countermeasures/CM0022_QuarantineSuspiciousFiles.md)|Quarantine Suspicious Files|Quarantining suspicious files terminates adversary execution of malware.|
|[CM0023](./countermeasures/CM0023_IdentifyAndTerminateSuspiciousProcesses.md)|Identify and Terminate Suspicious Processes|Identifying and terminating suspicious processes terminates adversary|
|[CM0024](./countermeasures/CM0024_DisconnectInternetfacingBoundaryControllers.md)|Disconnect Internet-facing Boundary Controllers|Disconnecting Internet-facing boundary controllers terminates adversary|
|[CM0025](./countermeasures/CM0025_DisableRemoteDesktopProtocol.md)|Disable Remote Desktop Protocol (RDP)|Disabling the Remote Desktop Protocol (RDP) blocks adversary initial|
|[CM0026](./countermeasures/CM0026_RebootServers.md)|Reboot Servers|Rebooting servers blocks adversary initial access using patched|
|[CM0027](./countermeasures/CM0027_RebuildCompromisedHost.md)|Rebuild Compromised Host|Rebuilding a compromised host terminates adversary persistence, command|
|[CM0028](./countermeasures/CM0028_ResetServiceAccountPasswords.md)|Reset Service Account Passwords|Resetting service account passwords restricts adversary persistence and lateral movement using valid accounts.|
|[CM0029](./countermeasures/CM0029_ResetNtHashesForSmartCardenabledAccounts.md)|Reset NT Hashes for Smart Card-enabled Accounts|Resetting NT hashes for smart card-enabled accounts restricts adversary|
|[CM0030](./countermeasures/CM0030_RemoveKnownMalware.md)|Remove Known Malware|Removing known malware terminates adversary collection, persistence, and|
|[CM0031](./countermeasures/CM0031_MonitorPowershellProgram.md)|Monitor PowerShell Program|Monitoring PowerShell detects adversary execution using PowerShell.|
|[CM0032](./countermeasures/CM0032_RevokeAndRegenerateSshKeys.md)|Revoke and Regenerate SSH Keys|Revoking and regenerating SSH keys terminates adversary persistence and lateral movement using compromised private keys.|
|[CM0033](./countermeasures/CM0033_ResetUserAccountPasswords.md)|Reset User Account Passwords|Resetting user account passwords restricts adversary persistence and lateral movement using valid accounts.|
|[CM0034](./countermeasures/CM0034_IdentifyAndBlockSuspiciousHosts.md)|Identify and Block Suspicious Hosts|Identifying and blocking suspicious hosts restricts adversary initial|
|[CM0035](./countermeasures/CM0035_ConfigureUniformResourceLocatorFiltering.md)|Configure Uniform Resource Locator (URL) Filtering|Configuring Uniform Resource Locator (URL) filtering restricts adversary initial access and execution via  malicious URLs.|
|[CM0036](./countermeasures/CM0036_IdentifyAndMonitorRemoteAccessTools.md)|Identify and Monitor Remote Access Tools|Disabling or restricting remote access tools blocks or restricts|
|[CM0037](./countermeasures/CM0037_EnableGeolocationbasedTrafficFiltering.md)|Enable Geolocation-based Traffic Filtering|Enabling geolocation-based traffic filtering restricts adversary|
|[CM0038](./countermeasures/CM0038_RemoveWindowsManagementInstrumentationEventSubscription.md)|Remove Windows Management Instrumentation (WMI) Event Subscription|Removing a Windows Management Instrumentation (WMI) event subscription terminates adversary persistence and/or lateral movement via malicious content execution triggered by a WMI event subscription. |
|[CM0039](./countermeasures/CM0039_MonitorWindowsManagementInstrumentationEvents.md)|Monitor Windows Management Instrumentation (WMI) Events|Monitoring Windows Management Instrumentation (WMI) events detects|
|[CM0040](./countermeasures/CM0040_ClearWorkstationAndServerDomainNameServerCaches.md)|Clear Workstation and Server Domain Name Server (DNS) Caches|Clearing workstation and server Domain Name Server (DNS) cache terminates collection and command-and-control (C2) via corrupted DNS lookups.|
|[CM0041](./countermeasures/CM0041_DisableServiceAccountInteractiveLogin.md)|Disable Service Account Interactive Login|Disabling service account interactive login restricts adversary lateral movement using service accounts.|
|[CM0042](./countermeasures/CM0042_RestrictRemoteDesktopProtocol.md)|Restrict Remote Desktop Protocol (RDP)|Restricting the Remote Desktop Protocol (RDP) restricts adversary initial access and lateral movement using RDP.|
|[CM0043](./countermeasures/CM0043_MonitorPermissionsForUserServiceAndAdministratorAccounts.md)|Monitor Permissions for User, Service, and Administrator Accounts|Monitoring permissions for user, service, and administrator accounts mitigates adversary privilege escalation using valid accounts.|
|[CM0044](./countermeasures/CM0044_MonitorAccountCreationAndPermissionChanges.md)|Monitor Account Creation and Permission Changes|Monitoring account creation and permission changes detects adversary|
|[CM0045](./countermeasures/CM0045_DisableOrMonitorExecutionOfWmic.md)| Disable or Monitor Execution of WMIC.exe|Disabling or monitoring execution of wmic.exe will either prevent or alert to adversaries executing local or remote commands for lateral movement or persistence. |
|[CM0046](./countermeasures/CM0046_BlockExecutionOfCompiledHtmlFiles.md)|Block Execution of Compiled HTML (CHM) Files|Blocking execution of compiled HTML (CHM) files blocks adversary defense evasion using proxy execution of malicious CHM files.|
|[CM0047](./countermeasures/CM0047_BlockHighriskFileTypesAtWebGateway.md)|Block High-risk File Types at Web Gateway|Blocking high-risk file types at the web gateway restricts adversary initial access and execution. |
|[CM0048](./countermeasures/CM0048_DisableHyperv.md)| Disable Hyper-V|Disabling the native Windows Hyper-V hypervisor blocks adversary privilege escalation, lateral movement, and potential C2 capability facilitated by hyperjacking and/or host escape techniques. |
|[CM0049](./countermeasures/CM0049_DisableOrMonitorExecutablesWithSuidAndSgidBitsSet.md)|Disable or Monitor Executables with SUID and SGID Bits Set|Disabling or monitoring executables with SUID and SGID bits set prevents or detects adversaries from performing privilege escalation using misconfigured application permissions. |
|[CM0050](./countermeasures/CM0050_ResetKerberosTicketGrantingTicketPasswordTwice.md)|Reset Kerberos Ticket Granting Ticket (KRBTGT) Password Twice|Reseting the Kerberos Ticket Granting Ticket (KRBTGT) password twice will terminate adversary credential access via Golden Ticket attacks.|
|[CM0051](./countermeasures/CM0051_DisableBluetooth.md)|Disable Bluetooth|Disabling Bluetooth will prevent adversary objectives of exfiltration and command and control that are achieved by exploiting the Bluetooth protocol.|
|[CM0052](./countermeasures/CM0052_DisableNetbiosService.md)|Disable NetBIOS Service|Disabling the NetBIOS service blocks adversary initial access and lateral movement directives that exploit the NetBIOS service and port pairing.|
|[CM0053](./countermeasures/CM0053_DisableLinklocalMulticastNameResolutionService.md)|Disable Link-Local Multicast Name Resolution (LLMNR) Service|Disabling the Link-Local Multicast Name Resolution (LLMNR) service disrupts adversary credential access and collection via man-in-the-middle and LLMNR poisoning behaviors.|
|[CM0054](./countermeasures/CM0054_BlockOrRestrictRemovableMedia.md)|Block or Restrict Removable Media|Blocking or restricting removable media blocks adversary initial access and lateral movement using malware located on removable media and blocks adversary exfiltration using removable media.|
|[CM0055](./countermeasures/CM0055_ImplementSpfDkimAndDmarcEmailAuthenticationMethods.md)|Implement SPF, DKIM, and DMARC Email Authentication Methods|Enabling Sender Policy Framework (SPF), DomainKeys Identified Mail (DKIM), and Domain-based Message Authentication Reporting and Conformance (DMARC) email authentication methods restricts adversary initial access via email sent on behalf of a domain they do not own. |
|[CM0056](./countermeasures/CM0056_DisableVisualBasicForApplicationsMacros.md)|Disable Visual Basic for Applications (VBA) Macros|Disabling macros prevents the execution of Visual Basic for Applications (VBA) in Office documents that could otherwise afford an adversary the opportunity to achieve user-driven execution.    |
|[CM0057](./countermeasures/CM0057_VerifySigningOfApplescripts.md)|Verify Signing of AppleScripts|Verifying that AppleScripts are signed by a trusted developer ID restricts an adversary's ability to arbitrarily execute untrusted AppleScripts.|
|[CM0058](./countermeasures/CM0058_DetectAndBlockExecutionOfVulnerableDrivers.md)|Detect and Block Execution of Vulnerable Drivers|Detecting and blocking the execution of vulnerable drivers prevents and/or detects adversaries attempting to use vulnerable drivers to evade defenses and escalate privileges. |
|[CM0059](./countermeasures/CM0059_ConfigureTacticalPrivilegedAccessWorkstation.md)|Configure Tactical Privileged Access Workstation|Configuring a tactical privileged access workstation (PAW) enables privileged administrators to respond to an incident while minimizing the exposure of privileged administrator accounts.|
|[CM0060](./countermeasures/CM0060_RestrictAndMonitorDomainAccountsWithLocalAdministratorAccessToWorkstations.md)|Restrict and Monitor Domain Accounts with Local Administrator Access to Workstations|Restricting and monitoring domain accounts with local administrator access to standard workstations prevents privilege escalation and impedes attempts at credential access and lateral movement. |
|[CM0061](./countermeasures/CM0061_RotateMailboxPasswords.md)|Rotate Mailbox Passwords|Rotating mailbox passwords reduces the risk of unauthorized access, data breaches, and mailbox misuse for malicious purposes.|
|[CM0062](./countermeasures/CM0062_MonitorOrBlockServerMessageBlockProtocol.md)|Monitor or Block Server Message Block (SMB) Protocol|Monitoring and/or blocking the Server Message Block (SMB) protocol detects and/or blocks adversary lateral movement and command and control using SMB.  |
|[CM0063](./countermeasures/CM0063_InvestigateSuspiciousLoginAttempts.md)|Investigate Suspicious Login Attempts|Investigating suspicious login attempts detects adversary credential access and lateral movement.  |
|[CM0064](./countermeasures/CM0064_InvestigateAccountManipulation.md)|Investigate Account Manipulation|Investigating account manipulation detects and terminates adversary persistence and privilege escalation.|
|[CM0065](./countermeasures/CM0065_IsolateEndpointsFromNetwork.md)|Isolate Endpoints from Network|Isolating an endpoint from the network blocks adversary initial access, lateral movement, and command and control to and from the host on a network.|
|[CM0066](./countermeasures/CM0066_UpdateFirmware.md)|Update Firmware|Updating firmware restricts adversary impact, privilege escalation, and lateral movement.|
|[CM0067](./countermeasures/CM0067_InstallCriticalSoftwareSecurityUpdates.md)|Install Critical Software Security Updates|Installing critical software security updates restricts adversary execution, persistence, credential access, lateral movement, collection, privilege escalation, and initial access techniques that exploit unpatched and vulnerable software.|
|[CM0068](./countermeasures/CM0068_AuditAndRestrictExchangeApplicationimpersonationRole.md)|Audit and Restrict Exchange ApplicationImpersonation Role|Auditing and restricting the Exchange ApplicationImpersonation role detects and disrupts adversary persistence and privilege escalation. |
|[CM0069](./countermeasures/CM0069_ResetDirectoryServicesRestoreModeAccountPasswordsOnDomainControllers.md)|Reset Directory Services Restore Mode (DSRM) Account Passwords on Domain Controllers|Resetting Directory Services Restore Mode (DSRM) account passwords on domain controllers terminates adversary persistence on local Active Directory (AD) databases via the DSRM account.|
|[CM0070](./countermeasures/CM0070_ResetDomainControllerMachineAccountPassword.md)|Reset Domain Controller (DC) Machine Account Password|Resetting the Domain Controller's account password terminates adversary persistence using stolen domain controller machine account credentials. |
|[CM0071](./countermeasures/CM0071_UnenrollSuspiciousMultifactorAuthenticationDeviceFromMicrosoftUserAccount.md)|Unenroll Suspicious Multifactor Authentication (MFA) Device from Microsoft User Account|Unenrolling a suspicious Multifactor Authentication (MFA) device from a Microsoft user account terminates adversary persistence to environments granted by the device.|
|[CM0072](./countermeasures/CM0072_DisableCredentialCaching.md)|Disable Credential Caching |Disabling credential caching prevents adversaries from accessing credentials stored in the domain cache. |
|[CM0073](./countermeasures/CM0073_RotateActiveDirectoryFederationServicesCertificates.md)|Rotate Active Directory Federation Services (AD FS) Certificates|Rotating Active Directory Federation Services (AD FS) certificates terminates adversary credential access via forged Security Assigned Markup Language (SAML) tokens.|
|[CM0074](./countermeasures/CM0074_AuditAndRestrictMailboxPermissions.md)|Audit and Restrict Mailbox Permissions|Auditing and restricting mailbox permissions detects and blocks adversary exfiltration using mailboxes.|
|[CM0075](./countermeasures/CM0075_ImplementAccessRestrictionsOnCloudStorageObjects.md)|Implement Access Restrictions on Cloud Storage Objects |Implementing access restrictions on cloud storage objects restricts an adversary's ability to discover contents/information within cloud storage.|
|[CM0076](./countermeasures/CM0076_RemoveAdversaryCertificatesAndRotateSecretsForApplicationsAndServicePrincipals.md)|Remove Adversary Certificates and Rotate Secrets for Applications and Service Principals |Removing adversary certificates and rotating secrets for applications and service principals terminates persistence via adversary-controlled credentials.|
|[CM0077](./countermeasures/CM0077_RevokeMicrosoft365RefreshTokens.md)|Revoke Microsoft 365 Refresh Tokens|Revoking Microsoft 365 (M365) refresh tokens terminates adversary lateral movement and defensive evasion using compromised tokens upon expiration of their access token.|
|[CM0078](./countermeasures/CM0078_DisableOrMonitorWindowsScriptHostAdministrationTool.md)|Disable or Monitor Windows Script Host (WSH) Administration Tool|Disabling or monitoring the Windows Script Host (WSH) administration tool blocks or detects adversary execution of script-based malware via WSH.|
|[CM0079](./countermeasures/CM0079_ResetActiveDirectoryServicesConnectorAccountPassword.md)|Reset Active Directory Services (AD DS) Connector Account Password|Resetting the Active Directory Services (AD DS) Connector account password eliminates persistence and privilege escalation via hijacking of AD DS Connector account.|
|[CM0080](./countermeasures/CM0080_BlockAndReissueTokens.md)|Block and Reissue Tokens|Blocking and reissuing tokens blocks adversary persistence and lateral movement using tokens.|
|[CM0081](./countermeasures/CM0081_RebuildCitrixNetscalerAppliances.md)|Rebuild Citrix NetScaler Appliances |Rebuilding NetScaler appliances disrupts adversary discovery and credential access via session hijacking NetScaler Application Delivery Controller (ADC). |
|[CM0082](./countermeasures/CM0082_IdentifyAndRemoveSuspiciousEmailForwardingRules .md)|Identify and Remove Suspicious Email Forwarding Rules |Identifying and removing suspicious email forwarding rules restricts adversary collection using compromised e-mail accounts. |
|[CM0083](./countermeasures/CM0083_RotateApplicationProgrammingInterfaceKeys.md)| Rotate Application Programming Interface (API) Keys|Rotating API keys disrupts privilege escalation, credential access, defense evasion, lateral movement, and persistence using stolen API keys.|
|[CM0084](./countermeasures/CM0084_RestrictAccountsWithPrivilegedActiveDirectoryAccessFromLoggingIntoEndpoints.md)|Restrict Accounts with Privileged Active Directory (AD) Access from Logging into Endpoints|Restricting accounts with privileged Active Directory (AD) access from logging into endpoints blocks adversary lateral movement via privileged AD access.|
|[CM0085](./countermeasures/CM0085_AuditGroupPolicyObjectsInActiveDirectory.md)|Audit Group Policy Objects (GPOs) in Active Directory (AD)|Auditing Group Policy Objects (GPOs) in Active Directory (AD) restricts adversary persistence, privilege escalation, and execution.|
|[CM0086](./countermeasures/CM0086_RebootWorkstations.md)|Reboot Workstations|Rebooting workstations removes memory-resident malware from Random Access Memory (RAM). |
|[CM0087](./countermeasures/CM0087_DisableCredentialCachingInTheWdigestAuthenticationProtocol.md)|Disable Credential Caching in the WDigest Authentication Protocol|Disabling credential caching in the WDigest authentication protocol restricts adversary credential access and privilege escalation.|
|[CM0088](./countermeasures/CM0088_EnableCredentialGuard.md)|Enable Credential Guard|Enabling Credential Guard restricts adversary credential access.  |
|[CM0089](./countermeasures/CM0089_EnableLocalSecurityAuthorityProtections.md)|Enable Local Security Authority (LSA) Protections|Enabling Local Security Authority (LSA) protections blocks adversary credential access via Local Security Authority Subsystem Service (LSASS) process memory dumping.  |
|[CM0090](./countermeasures/CM0090_DetectAttemptsToAccessLocalSecurityAuthoritySubsystemServiceProcess.md)|Detect Attempts to Access Local Security Authority Subsystem Service (LSASS) Process|Detecting attempts to access the Local Security Authority Subsystem Service (LSASS) process detects adversary credential access via LSASS credential dumping.|
|[CM0091](./countermeasures/CM0091_PreventAndDetectSystemBinaryProxyExecution.md)|Prevent and Detect System Binary Proxy Execution|Preventing and detecting abuse of trusted system binaries restricts and detects adversary malicious code execution. |
|[CM0092](./countermeasures/CM0092_ResetEntraSeamlessSignonAccountPassword.md)|Reset Entra Seamless Sign-on Account Password|Resetting the Microsoft Entra seamless sign-on account password terminates persistence and privilege escalation via hijacking of the seamless sign-on account.|
|[CM0093](./countermeasures/CM0093_PreventAndDetectNetworkTrafficTofromTheOnionRouterExitNodes.md)|Prevent and Detect Network Traffic to/from The Onion Router (Tor) Exit Nodes|Preventing and detecting network traffic to/from The Onion Router (Tor) exit nodes protects against attempts at reconnaissance, initial access, command-and-control (C2), exfiltration, and impact originating from, or destined to the Tor network.|
|[CM0094](./countermeasures/CM0094_RestrictDomainAdminUserRightsAndMonitorProtectedUsersOnWorkstations.md)|Restrict Domain Admin User Rights and Monitor Protected Users on Workstations|Restricting Domain Admin user rights and monitoring Protected Users on workstations and servers limits the likelihood of privileged credential access via credential dumping.|
|[CM0095](./countermeasures/CM0095_DetectAttemptsToModifyOrDisableDefenderFromTheCommandLine.md)|Detect Attempts to Modify or Disable Defender from the Command Line |Detecting attempts to abuse command line utilities to modify or disable Windows Defender alerts responders to attempts to evade defenses.|
|[CM0096](./countermeasures/CM0096_PreventAndDetectAttemptsToCopyNtDirectoryServicesDatabaseInformationTable.md)|Prevent and Detect Attempts to Copy NT Directory Services Database Information Table (NTDS.dit)|Preventing and detecting attempts to copy the NT Directory Services Database Information Table (NTDS.dit) will prevent and alert defenders to attempts to duplicate the file for exfiltration. |
|[CM0097](./countermeasures/CM0097_DetectAttemptsToDeleteShadowCopies.md)|Detect Attempts to Delete Shadow Copies|Detecting the deletion of shadow copies will alert defenders to an adversary attempting to destroy volume backups.     |
|[CM0098](./countermeasures/CM0098_EnableExtendedProtectionForAuthentication.md)|Enable Extended Protection for Authentication (EPA) |Enabling Extended Protection for Authentication on clients and servers restricts adversary credential access and lateral movement facilitated by man-in-the-middle (MITM) or relay attacks.|
|[CM0099](./countermeasures/CM0099_RemoverotateKubernetesServiceAccountToken.md)|Remove/Rotate Kubernetes Service Account Token|Removing Kubernetes service account tokens, and/or rotating as needed, disrupts adversary credential access via Kubernetes service account token theft. |
|[CM0100](./countermeasures/CM0100_RestrictAndMonitorRemoteProcedureCalls.md)|Restrict and Monitor Remote Procedure Calls (RPC)|Restricting and monitoring Remote Procedure Calls (RPC) limits opportunities for an adversary to conduct reconnaissance and achieve execution, lateral movement, and privilege escalation via RPC abuse. |
|[CM0101](./countermeasures/CM0101_BlockApplicationsInWritableLocationsUsingApplocker.md)|Block Applications in Writable Locations using AppLocker|Blocking applications in writable locations using AppLocker blocks execution by malware in compromised environments. |
|[CM0102](./countermeasures/CM0102_RemoveCachedDomainCredentialsFromWorkstation.md)|Remove Cached Domain Credentials From Workstation|Removing cached domain credentials from workstations prevents adversaries from pursuing credential access via password stores and OS credential dumping. |
|[CM0103](./countermeasures/CM0103_DenyLogonAsABatchJob.md)|Deny Logon as a Batch Job|Denying log on as a batch job for a particular account disrupts the ability for an adversary to automate tasks or execute malicious scripts at specified times. |
|[CM0104](./countermeasures/CM0104_EnableInteractiveLogonAndRequireSmartCardPolicyForPrivilegedUserAccounts.md)|Enable Interactive Logon and Require Smart Card Policy for Privileged User Accounts|Enabling Interactive logon and requiring smart card policy for privileged user accounts prevents adversaries from logging into privileged accounts via cracked credentials.|
|[CM0105](./countermeasures/CM0105_RemoveMaliciousEnterpriseApplicationsAndServiceAccountPrincipals.md)|Remove Malicious Enterprise Applications and Service Account Principals|Removing malicious applications and service account principals blocks an adversary's persistance via applications and service principals in the environment. |
|[CM0106](./countermeasures/CM0106_EliminateWebShells.md)|Eliminate Web Shells|Eliminating web shells removes malicious code from vulnerable web servers that enable initial access and persistence.|
|[CM0107](./countermeasures/CM0107_RestoreSysvolContentInAdDomains.md)|Restore SYSVOL Content in AD Domains|Restoring SYSVOL content terminates adversary defense evasion, persistence, privilege escalation, lateral movement, and impact via malicious GPOs and malware staged in the SYSVOL directory.|
|[CM0108](./countermeasures/CM0108_DetectRogueVirtualMachines.md)|Detect Rogue Virtual Machines|Detecting rogue virtual machines (VMs) identifies a common initial access and persistence technique employed in virtualized environments.|
|[CM0109](./countermeasures/CM0109_AuditAndRestrictCronDaemon.md)|Audit and Restrict Cron Daemon|Auditing and restricting the use of the Linux Cron daemon prevents adversary persistence and privilege escalation capabilities.|
|[CM0110](./countermeasures/CM0110_DetectAntimalwareScanInterfaceBypassAttempts.md)|Detect Anti-Malware Scan Interface (AMSI) Bypass Attempts|Detecting adversary attempts to bypass or disable the Anti-Malware Scan Interface (AMSI) blocks or restricts the adversary from defense evasion and actions on objectives using malicious scripts or macros. |
|[CM0111](./countermeasures/CM0111_EnableMultipleAdministrativeApprovalForAccessPolicies.md)|Enable Multiple Administrative Approval (MAA) for Access Policies|Enabling multiple administrative approval (MAA) across Microsoft access policies restricts an adversary from compromising a domain/administrative account to achieve privilege escalation and persistence.|
|[CM0112](./countermeasures/CM0112_RemoveExtraneousAndStaleAccounts.md)|Remove Extraneous and Stale Accounts|Removing extraneous and stale accounts blocks or restricts adversary initial access, persistence, defense evasion, and lateral movement using said accounts. |
|[CM0113](./countermeasures/CM0113_DisableMicrosoftOfficeAddins.md)|Disable Microsoft Office Add-ins|Disabling Microsoft (MS) Office add-ins blocks an adversary from maintaining persistence using MS Office Add-ins. |
|[CM0114](./countermeasures/CM0114_EnableMicrosoftConditionalAccessPolicyTemplates.md)|Enable Microsoft Conditional Access Policy Templates|Enabling Microsoft Conditional Access Policy templates blocks or restricts an adversary from lateral movement and privilege escalation using legitimate credentials. |
|[CM0115](./countermeasures/CM0115_BlockUntrustedAndUnsignedProcessesThatRunFromUsb.md)|Block Untrusted and Unsigned Processes that Run from USB|Blocking untrusted and unsigned processes that run from USB blocks lateral movement via malicious execution on hosts via USB.|
|[CM0116](./countermeasures/CM0116_RestrictVisualBasicForApplicationsMacros.md)|Restrict Visual Basic for Applications (VBA) Macros|Restricting macros blocks adversary persistence and lateral movement using malicious Visual Basic for Applications (VBA) macros.|
|[CM0117](./countermeasures/CM0117_DisableOrMonitorConnectionManagerProfileInstaller.md)|Disable or Monitor Connection Manager Profile Installer (CMSTP.exe)|Disabling the Connection Manager Profile Installer (CMSTP.exe) prevents an adversary's attempts to evade defenses and achieve proxy execution using CMSTP.|
|[CM0118](./countermeasures/CM0118_RevokeExistingAdministratorPermissionsAndDeployNewAdministratorAccounts.md)|Revoke Existing Administrator Permissions and Deploy New Administrator Accounts|Revoking existing administrator accounts and permissions and deploying new ones blocks an adversary from persistence, lateral movement, and privilege escalation using existing administrator credentials. |
|[CM0119](./countermeasures/CM0119_DisableAutoplay.md)|Disable Autoplay|Disabling Autoplay prevents the spread of malware via removable media. |
|[CM0120](./countermeasures/CM0120_RemoveCronJob.md)|Remove Cron Job|Removing a malicious or manipulated Cron job prevents adversarial objectives of execution, persistence, and privilege escalation.|
|[CM0121](./countermeasures/CM0121_EnableManagedDomainAuthentication.md)|Enable Managed Domain Authentication|Enabling managed domain authentication blocks or prevents abuse of legacy authentication methods or misconfigured domain infrastructure to achieve initial access or persistence. |
|[CM0122](./countermeasures/CM0122_RestrictSysvolCredentialTheft.md)|Restrict SYSVOL Credential Theft|Restricting access to credentials stored in SYSVOL folders prevents adversaries from stealing or misusing sensitive data embedded in Group Policy Preferences (GPP) thereby limiting their ability to escalate privileges, maintain persistence, and/or perform lateral movement using the acquired credentials.|
|[CM0123](./countermeasures/CM0123_RemoveMaliciousDomainTrustFromTenant.md)|Remove Malicious Domain Trust from Tenant|Removing malicious domain trusts from the tenant prevents an adversary from achieving initial access or performing discovery by abusing trusted domains. |
|[CM0124](./countermeasures/CM0124_DisableOnpremiseActiveDirectoryAccountsWithPrivilegedRolesInEntraId.md)|Disable On-Premise Active Directory (AD) Accounts with Privileged Roles in Entra ID|Disabling privileged on-premises Active Directory (AD) accounts in Entra ID prevents an adversary's attempts to achieve persistence or privilege escalation by abusing administrator or domain accounts.|
|[CM0125](./countermeasures/CM0125_ResetAndMonitorAdmincountAttribute.md)|Reset and Monitor adminCount Attribute|Resetting and monitoring the adminCount attribute blocks or prevents an adversary's attempts to achieve persistence or privilege escalation by abusing properties of adminCount. |
|[CM0126](./countermeasures/CM0126_ResetCredentialsForLocalAdministratorAccountsTwice.md)|Reset Credentials for Local Administrator Accounts Twice|Resetting credentials for local administrator accounts twice blocks or prevents an adversary's initial access and persistence via local administrator accounts. |
|[CM0127](./countermeasures/CM0127_DisableMicrosoftXmlCoreServices.md)|Disable Microsoft XML Core Services (MSXSL.exe)|Disabling Microsoft XML Core Services (MSXSL.exe) prevents an adversary's attempts at defense evasion and arbitrary code execution by abusing the MSXSL.exe utility. |
|[CM0128](./countermeasures/CM0128_ResetCredentialsForGlobalAndDomainAdministratorAccountsTwice.md)|Reset Credentials for Global and Domain Administrator Accounts Twice|Resetting credentials for global and domain administrators twice prevents an adversary's persistence using compromised global or domain administrator accounts. |
|[CM0129](./countermeasures/CM0129_EliminateHiddenRegistryKeys.md)|Eliminate Hidden Registry Keys|Eliminating hidden registry keys will eliminate adversarial attempts to evade defenses and achieve persistence by hiding malicious code in the registry.  |
|[CM0130](./countermeasures/CM0130_DisableOrRestrictMicrosoftBuildEngine.md)|Disable or Restrict Microsoft Build Engine (MSBuild.exe)|Disabling Microsoft Build Engine (MSBuild) prevents an adversary's attempts to evade defenses and deliver malware using MSBuild. |
|[CM0131](./countermeasures/CM0131_DisableOrRestrictMicrosoftManagementConsole.md)|Disable or Restrict Microsoft Management Console (MMC.exe)|Disabling the Microsoft Management Console prevents an adversary's attempts at remote code execution and defense evasion using malicious management saved console files. |
|[CM0132](./countermeasures/CM0132_DisableOrRestrictInstallutil.md)|Disable or Restrict InstallUtil|Disabling or restricting InstallUtil prevents an adversary's attempts at defense evasion and application control evasion using InstallUtil. |
|[CM0133](./countermeasures/CM0133_ResetAccessControlListsToDefaultValues.md)|Reset Access Control Lists to Default Values|Resetting Access Control Lists (ACLs) to default values blocks or restricts an adversary's attempts at persistence, privilege escalation, and defense evasion using created accounts or modified permissions.|
|[CM0134](./countermeasures/CM0134_AuditFederatedSystemsTrustSettings.md)|Audit Federated Systems Trust Settings|Auditing federated systems trust settings prevents an adversary's attempts at initial access, lateral movement, and persistence by abusing permissions or misconfigurations of federated trusts. |
|[CM0135](./countermeasures/CM0135_RebuildGroupManagedServiceAccounts.md)|Rebuild Group Managed Service Accounts (gMSA)|Rebuilding group managed service accounts (gMSA) prevents an adversary's attempts at initial compromise and privilege escalation by abusing gMSA. |
|[CM0136](./countermeasures/CM0136_ConfigureAndInvalidateRelativeIdPools.md)|Configure and Invalidate Relative ID (RID) Pools|Configuring and invalidating relative ID (RID) pools blocks or restricts an adversary's attempts to escalate privileges and achieve persistence by hijacking RID.  |
|[CM0137](./countermeasures/CM0137_RemoveGlobalCatalogFromDomainController.md)|Remove Global Catalog from Domain Controller|Removing the global catalog from domain controllers prevents an adversary's attempts at discovery via the global catalog. |
|[CM0138](./countermeasures/CM0138_AuditAndRemoveMaliciousUdevRules.md)|Audit and Remove Malicious Udev Rules|Auditing and removing malicious Udev rules detects and eliminates an adversary's attempts to achieve execution and persistence via malicious udev rules. |
|[CM0139](./countermeasures/CM0139_RebuildActiveDirectoryConnectServer.md)|Rebuild Active Directory (AD) Connect Server|Rebuilding the Active Directory (AD) Connect Server prevents an adversary's attempts to move laterally, escalate privileges, or cause destruction by abusing the AD Connect servers. |
|[CM0140](./countermeasures/CM0140_ConfigureWindowsAuditPolicy.md)|Configure Windows Audit Policy|Configuring the Windows Audit policy blocks or prevents an adversary from remaining undetected on a network.|
|[CM0141](./countermeasures/CM0141_AuditAndRestrictPsexec.md)|Audit and Restrict PsExec|Auditing and restricting PsExec blocks or prevents an adversary's attempts at persistence, lateral movement, exploitation, and defense evasion by abusing PsExec.|
|[CM0142](./countermeasures/CM0142_EnableLdapSigningAndChannelBinding.md)|Enable LDAP Signing and Channel Binding |Enabling Lightweight Directory Access Protocol (LDAP) signing, and channel binding prevents attempts at privilege escalation via LDAP relay attacks. |
|[CM0143](./countermeasures/CM0143_AuditAndConfigurePiWebApi.md)|Audit and Configure PI Web API|Auditing and configuring the Plant Information (PI) Web Application Programming Interface (API) prevents an adversary's attempts to perform discovery and achieve remote code execution via the API.  |
|[CM0144](./countermeasures/CM0144_AuditSysvolForVulnerableGroupPolicyPreferences.md)|Audit SYSVOL for Vulnerable Group Policy Preferences|Auditing vulnerable Group Policy Preferences (GPP) in Active Directory (AD) environments prevents the adversary from achieving defense evasion and persistence via harvesting GPP passwords.|
|[CM0145](./countermeasures/CM0145_ResetInterdomainTrustAccountCredentials.md)|Reset Interdomain Trust Account (ITA) Credentials|Resetting interdomain trust accounts (ITA) credentials prevents an adversary's attempts at initial access and lateral movement via compromised ITA credentials. |
|[CM0146](./countermeasures/CM0146_ConfigureFlexibleSingleMasterOperationsRoles.md)|Configure Flexible Single Master Operations (FSMO) Roles|Configuring flexible single master operations (FSMO) roles slows down an adversary's exploitation of the domain via compromised domain controllers. |
|[CM0147](./countermeasures/CM0147_RemoveSuspiciousScheduledTasks.md)|Remove Suspicious Scheduled Tasks|Auditing Windows Task Scheduler prevents adversary attempts at persistence, execution, or priviledge escalation via malicious tasks.|
|[CM0148](./countermeasures/CM0148_DisableCiscoOpenNxosGuestShell.md)|Disable Cisco Open NX-OS Guest Shell|Disabling the Cisco NX-OS Guest Shell prevents adversaries from abusing the guest shell to maintain persistent access to a compromised environment.|
|[CM0149](./countermeasures/CM0149_TemporarilyDisableCiscoOpenNxosGuestShell.md)|Temporarily Disable Cisco Open NX-OS Guest Shell|Restricting the Cisco NX-OS Guest Shell prevents adversaries from abusing the guest shell to maintain persistent access to a compromised environment|
|CM0150 - IP.P| Limit Management Traffic Exposure to the Internet | TBD |
|CM0151 - PRU| Enable SMB Signing to stop NTLMv2 relay | TBD |
|CM0152 - PE.Da| Rotate SNMP Community Strings | TBD |
|[CM0153](./countermeasures/CM0153_ImplementComplexPasswordPolicyCiscoDevices.md)| Implement Complex Password Policy for Cisco Devices | Auditing passwords under robust password complexity requirements prevents adversary privilege escalation and persistence via abuse of privileged EXEC mode across Cisco devices. |
|CM0154 - PRA.P| Implement Password Storage Algorithms for Cisco Devices | TBD |
|CM0155 - IP.I| Audit and Configure OPC UA Protocol | TBD |
|[CM0156](./countermeasures/CM0156_AuditandRestrictCiscoCLIPriveleges.md)| Audit and Restrict Cisco CLI Privileges | Restricting command line execution across Cisco devices to privileged levels prevents adversary objectives in privilege escalation and discovery by accessing running device configurations. |
|[CM0157](./countermeasures/CM0157_DisableUnauthorizedOpenPorts.md)| Disable Unauthorized Open Ports | Disabling unauthorized open ports prevents adversaries from establishing persistence, lateral movement, and command and control foothold via the setup of unauthorized services, backdoors, or exfiltration channels on unused or high-numbered ports. |
|CM0158 - PE.S| Disable or Restrict All Remote Access Tools | TBD |
|CM0159 - PRA.P| Upgrade SNMP to Latest Version | TBD |
|CM0160 - IP.E| Implement Strict Deny ACL Strategy to Control Inbound/Egressing Traffic | TBD |

## Title/Outcome Statement Related Issues
These SOP-specified items frequently need to be corrected during review:
- Title in document should not include the identifier (e.g., "Rotate Mailbox Passwords" rather than "CM0041: Rotate Mailbox Passwords).
- Acronyms should be expanded in title (with acronym given) and the first time used in the Intended Outcome statement.

Standardization of Titles and Intended Outcome statements is now optional, but if aiming for standardization, these guidelines apply:
- Intended Outcomes should include explicit ATT&CK Tactics (e.g., persistence)
- Type property in metadata should contain value(s) taken from the following capitalized terms (not the action words in parentheses):
    - *Disable* (disable, block, restrict, revoke, prevent)
    - *Eliminate* (eliminate, remove, quarantine, isolate, terminate, clear)
    - *Enable* (enable, implement, leverage, install, create, configure)
    - *Refresh* (refresh, reboot, rebuild, regenerate, reissue, reset, rotate, update)
    - *Examine* (examine, detect, monitor, identify, investigate, verify, audit)

## Countermeasures - Potential
See [Potential Countermeasures](PotentialCountermeasures.md). Countermeasures chosen for development will be moved to the Master List.

## Countermeasures - Closed (Obsolete)
The table below shows countermeasures determined to be obsolete. They were marked "Closed" in Jira. If there is an associated countermeasure document, it is captured as a Jira comment.

|ID |Countermeasure Title|Intended Outcome|
|---|--------------------|----------------|
|~~RM0009~~|Verify/Configure System File and Directory Permissions |Verifying system file and directory permissions, and configuring as needed, blocks adversary privilege escalation using lax permissions. INTEGRATED INTO CM0003|
|~~RM0011~~|Audit privileges of user accounts according to JIT/JEA|&&& Not started &&&** ADD JEA REF TO ANOTHER CM (RM0012 or CM0085, which are similar - ref already in CM0085)|
|~~RM0012~~|Verify/Configure Standard User Privilege Levels|Verifying standard user privilege levels, and configuring as needed, restricts adversary privilege escalation using standard user accounts. TO BE INTEGRATED INTO CM0085|
|~~RM0112~~|Disable New Technology LAN Manager (NTLM) Protocol |Disabling the New Technology LAN Manager (NTLM) protocol retricts adversary credential access, lateral movement, and execution using NTLM. CLOSED - RECREATED AS CM0099 |
|~~RM0232~~|Enable Local Administrative Password Solution (LAPS) |Enabling Local Administrative Password Solution (LAPS) restricts adversary credential access to local administrator passwords. MARKED DONE BUT NOT MERGED. CHANGED TO CLOSED - review comment was LAPS would not be implemented as incident response.|
|~~RM0290~~|Audit and Configure Network Devices|&&& Not started &&& CLOSED|
|~~RM0371~~|Reissue Authentication Tokens|&&& Not Started &&& SEE CM0067|
|~~RM0442~~|Restrict PowerShell Program|Restricting the PowerShell program restricts adversary execution using PowerShell. CLOSED per Shane's eval.|
|~~RM0446~~|Verify/Configure Account Permissions and Authentication Methods|Verifying account permissions and authentication methods, and configuring as needed, restricts adversary privilege escalation using lax account settings. CLOSED|
|~~RM0453~~|Audit User Accounts for Unusual or Unauthorized Activity|Auditing user accounts for unusual or unauthorized activity detects adversary credential access, lateral movement, and privilege escalation. ARCHIVED (scope too narrow).|
|~~RM0460~~|Limit Unnecessary Lateral Communication|overlap with CM0047|
